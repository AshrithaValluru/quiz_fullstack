# .github/workflows/ci.yml
# CI for your repo â€” frontend (QZ_!) and backend (quiz-backend-simple-auth)

name: "CI - Frontend & Backend"

on:
  push:
    branches:
      - main
      - 'feature/**'
  pull_request:
    branches:
      - main

jobs:
    frontend:
    name: "Frontend (Node.js)"
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: "./QZ_!"
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Use Node.js 18
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          # removed `cache: 'npm'` because a lockfile isn't guaranteed to exist

      - name: Install dependencies
        run: |
          # if a lockfile exists use npm ci (reproducible), otherwise fallback to npm install
          if [ -f package-lock.json ] || [ -f npm-shrinkwrap.json ] || [ -f yarn.lock ]; then
            npm ci
          else
            npm install
          fi

  backend:
    name: "Backend (Maven)"
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: "./quiz-backend-simple-auth"   # repo folder for backend
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Java 17
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
          cache: 'maven'

      - name: Build and run tests with Maven
        run: |
          if [ -f pom.xml ]; then
            mvn -B clean verify; else echo "no pom.xml found, skipping maven build"; fi
